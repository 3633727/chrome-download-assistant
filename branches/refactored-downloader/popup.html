<html>
<head>
<style type="text/css">
body {
  font-family: arial, sans-serif;
  font-size: 13px;
  width: 230px;
}
.menu {
  border: 1px solid #bec9ce;
  margin-top: 5px;
  line-height: 22px;
  text-indent: 1em;
  width: 220px;
}
.menu {
  color: #3d5d6a;
  cursor: pointer;
}
.menu:hover {
  background-color: #3d5d6a;
  color: #ffffff;
}

</style>
<script>
function init() {
  var menu = document.getElementById('menu');
  createMenu(menu);
}

function createMenu(parentElement) {
  var bg = chrome.extension.getBackgroundPage();
  var plugin = bg.plugin;
  var enableDownloaders = bg.downloaderManager.getEnableDownloader(plugin);
  for (var i = 0; i < enableDownloaders.length; i++) {
    var item = enableDownloaders[i];
    if (item.supportDownloadAll) {
      var menuItem = document.createElement('DIV');
      menuItem.className = 'menu';
      menuItem.innerText = chrome.i18n.getMessage(item.showName2);
      console.log(menuItem.innerText);
      (function(element, downloader) {
        element.onclick = function() {
          chrome.tabs.executeScript(null,
              {code: 'npDownload.sendDownloadAllCommandToBg("' +
              downloader + '");'}, function() {
            //window.close();
          });
        }
      })(menuItem, item.name);
      parentElement.appendChild(menuItem);
    }
  }
}

</script>
</head>
<body onload="init()">
  <div id="menu">

  </div>
</body>
</html>
